<script setup>
import { ref } from "vue"

const today = new Date()
const year = today.getFullYear()
const month = today.getMonth()
const todayDay = today.getDate()

const monthName = new Date(year, month).toLocaleString("default", {
  month: "long",
  year: "numeric",
})

// ğŸ”¹ Per-day entries (local for now)
const entries = ref({
  26: { calories: 1800, exercise: 30, water: 7, score: 80 }
})

const daysInMonth = new Date(year, month + 1, 0).getDate()
const days = Array.from({ length: daysInMonth }, (_, i) => i + 1)

const selectedDay = ref(null)

// Helpers
const getEntry = (day) =>
  entries.value[day] || { calories: "", exercise: "", water: "", score: "" }

const updateEntry = (day, key, value) => {
  if (!entries.value[day]) entries.value[day] = {}
  entries.value[day][key] = value
}
</script>

<template>
  <section class="bg-slate-900 rounded-2xl p-4 shadow space-y-4">
    <h2 class="text-lg font-semibold">{{ monthName }}</h2>

    <!-- Weekdays -->
    <div class="grid grid-cols-7 text-xs text-slate-400 text-center">
      <div v-for="d in ['S','M','T','W','T','F','S']" :key="d">{{ d }}</div>
    </div>

    <!-- Calendar Grid -->
    <div class="grid grid-cols-7 gap-2">
      <button
        v-for="day in days"
        :key="day"
        @click="selectedDay = day"
        class="aspect-square rounded-xl flex flex-col items-center justify-center text-sm transition"
        :class="[
          day === todayDay ? 'bg-indigo-600 text-white' : 'bg-slate-800',
          selectedDay === day ? 'ring-2 ring-yellow-400' : ''
        ]"
      >
        <span>{{ day }}</span>
        <span
          v-if="entries[day]?.score"
          class="text-yellow-400 text-xs leading-none"
        >
          â­
        </span>
      </button>
    </div>

    <!-- Inline Day Edit -->
    <div
      v-if="selectedDay"
      class="bg-slate-800 rounded-xl p-4 space-y-3 text-sm"
    >
      <div class="font-semibold">Day {{ selectedDay }}</div>

      <div class="grid grid-cols-2 gap-3">
        <label class="flex flex-col">
          <span class="text-xs text-slate-400">ğŸ”¥ Calories</span>
          <input
            type="number"
            class="bg-slate-900 rounded-lg px-3 py-2"
            :value="getEntry(selectedDay).calories"
            @input="updateEntry(selectedDay, 'calories', $event.target.value)"
          />
        </label>

        <label class="flex flex-col">
          <span class="text-xs text-slate-400">ğŸƒ Exercise (min)</span>
          <input
            type="number"
            class="bg-slate-900 rounded-lg px-3 py-2"
            :value="getEntry(selectedDay).exercise"
            @input="updateEntry(selectedDay, 'exercise', $event.target.value)"
          />
        </label>

        <label class="flex flex-col">
          <span class="text-xs text-slate-400">ğŸ’§ Water</span>
          <input
            type="number"
            class="bg-slate-900 rounded-lg px-3 py-2"
            :value="getEntry(selectedDay).water"
            @input="updateEntry(selectedDay, 'water', $event.target.value)"
          />
        </label>

        <label class="flex flex-col">
          <span class="text-xs text-yellow-400">â­ Score</span>
          <input
            type="number"
            class="bg-slate-900 rounded-lg px-3 py-2 text-yellow-400"
            :value="getEntry(selectedDay).score"
            @input="updateEntry(selectedDay, 'score', $event.target.value)"
          />
        </label>
      </div>
    </div>
  </section>
</template>
